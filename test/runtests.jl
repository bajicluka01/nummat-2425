using Fresnel
using Test

@testset "Pravilno izračunane vrednosti za x med 0 in 1.5" begin
    # točne vrednosti pridobljene z WolframAlpha

    x = 0.0
    @test isapprox(fresnel_cos(x), 0.0, atol=5*10e-11)
    
    x = 1.0
    @test isapprox(fresnel_cos(x), 0.7798934003768228294742064136526901366306257081363209601031335831780, atol=5*10e-11)

    x = 0.25
    @test isapprox(fresnel_cos(x), 0.2497591503565431834592215178008857243781399770549380697377810451376, atol=5*10e-11)

    x = 0.33
    @test isapprox(fresnel_cos(x), 0.3290356801304759603664123202787860907427807927835669458690808590881, atol=5*10e-11)

    x = 0.92
    @test isapprox(fresnel_cos(x), 0.7701562976583929214767339024899393068349047029890393661669531482605, atol=5*10e-11)

    x = 1.45
    @test isapprox(fresnel_cos(x), 0.4932586114576502450829446529201894068750216771056453814180923397830, atol=5*10e-11)
end

@testset "Pravilno izračunane vrednosti za x<0" begin
    # točne vrednosti pridobljene z WolframAlpha

    x = -0.14
    @test isapprox(fresnel_cos(x), -0.139986730307035685530957939381148580862015795254789945901103703787, atol=5*10e-11)
    
    x = -3.4291
    @test isapprox(fresnel_cos(x), -0.463419676121585559386569753174261569969461738529188009148208453775, atol=5*10e-11)

    x = -12.3
    @test isapprox(fresnel_cos(x), -0.476736432992150480800256368920641330771588213520628354813701347199, atol=5*10e-11)

    x = -450.222
    @test isapprox(fresnel_cos(x), -0.499834178439802808908473831954057335501429721410326480697601197463, atol=5*10e-11)

    x = -2531.2531
    @test isapprox(fresnel_cos(x), -0.499950736837367278285568977884524925521092789108120556114851376787, atol=5*10e-11)
end

@testset "Pravilno izračunane vrednosti za x>1.5" begin
    # točne vrednosti pridobljene z WolframAlpha

    x = 1.002
    @test isapprox(fresnel_cos(x), 0.7798871130234459202992274342245128871716564173767787658619213263894, atol=5*10e-11)
    
    x = 5.5555555
    @test isapprox(fresnel_cos(x), 0.4441456073645234086941240342373078951649837727602609451368422906666, atol=5*10e-11)

    x = 6.51
    @test isapprox(fresnel_cos(x), 0.4728183813385479287835767887961982009647206121516617412533085818867, atol=5*10e-11)

    x = 25.388
    @test isapprox(fresnel_cos(x), 0.5095367548494732114076639599579511690985520161770226304258725057020, atol=5*10e-11)

    x = 100.0
    @test isapprox(fresnel_cos(x), 0.4999998986788178975594684635258306320442934065040467742928031272084, atol=5*10e-11)
end
